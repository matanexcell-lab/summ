<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8"/>
<title>סיכום שיחה</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<style>
body{font-family:system-ui;background:#f3f4f6;margin:0;padding:20px}
.card{background:white;border-radius:18px;padding:20px;max-width:520px;margin:auto}
select,input{width:100%;padding:10px;margin-top:6px;border-radius:10px;border:1px solid #ccc}
.btn{padding:12px;border:none;border-radius:999px;font-size:16px;cursor:pointer;margin-top:12px}
.btn-primary{background:#2563eb;color:white}
.btn-secondary{background:#ddd}
.hidden{display:none}
pre{background:#111;color:#fff;padding:12px;border-radius:12px;margin-top:12px}
</style>
</head>

<body>

<div class="card">
<h2>סיכום שיחה</h2>
<div id="form"></div>

<button class="btn btn-primary" onclick="next()">המשך</button>
<button class="btn btn-secondary" onclick="back()">חזרה</button>

<pre id="summary" class="hidden"></pre>
</div>

<script>
/* =====================
   הגדרות מוצרים
===================== */

// מוצרי פנסיה
const PENSION_PRODUCTS = [
  "קרן פנסיה"
];

// מוצרי השקעה
const INVESTMENT_PRODUCTS = [
  "קרן השתלמות",
  "קופת גמל",
  "קופת גמל להשקעה"
];

// מוצרים שיכולים לקבל הפקדות
const DEPOSIT_PRODUCTS = [
  ...PENSION_PRODUCTS,
  ...INVESTMENT_PRODUCTS
];

const EMPLOYMENT_TYPES = ["שכירה","עצמאית"]

/* =====================
   State
===================== */

let step = 0
let history = []
let data = {}

/* =====================
   Helpers
===================== */

function resolveProduct(){
  return data.product
}

/* =====================
   Render
===================== */

function render(){
  const f = document.getElementById("form")
  const s = document.getElementById("summary")
  s.classList.add("hidden")

  if(step === 0){
    f.innerHTML = `
      <div>בחר סוג מוצר</div>
      <select id="product">
        <option value="">בחר...</option>
        ${[...PENSION_PRODUCTS, ...INVESTMENT_PRODUCTS]
          .map(p => `<option ${data.product===p?"selected":""}>${p}</option>`)
          .join("")}
      </select>
    `
  }

  if(step === 1){
    f.innerHTML = `
      <div>מצב תעסוקתי</div>
      <select id="employment">
        <option value="">בחר...</option>
        ${EMPLOYMENT_TYPES.map(e =>
          `<option ${data.employment===e?"selected":""}>${e}</option>`
        ).join("")}
      </select>
    `
  }

  if(step === 2){
    f.innerHTML = `
      <div>אופי ההפקדה ב${data.product}</div>
      <select id="deposit">
        <option>ללא הפקדה</option>
        <option>הוראת קבע</option>
        <option>חד פעמי</option>
        <option>גם וגם</option>
      </select>
    `
  }

  if(step === 3){
    f.innerHTML = ""
    s.textContent =
`מוצר: ${data.product}
תעסוקה: ${data.employment}
אופי הפקדה: ${data.deposit}`
    s.classList.remove("hidden")
  }
}

/* =====================
   Navigation
===================== */

function next(){

  // שלב מוצר
  if(step === 0){
    const p = document.getElementById("product").value
    if(!p) return alert("בחר מוצר")
    data.product = p
    history.push(step)
    step = 1
    render()
    return
  }

  // שלב תעסוקה
  if(step === 1){
    const e = document.getElementById("employment").value
    if(!e) return alert("בחר מצב תעסוקתי")
    data.employment = e

    const p = resolveProduct()

    // לוגיקה מרכזית – בדיוק לפי הבקשה שלך
    if(
      DEPOSIT_PRODUCTS.includes(p) &&
      (
        (p === "קרן פנסיה" && e === "עצמאית") ||
        INVESTMENT_PRODUCTS.includes(p)
      )
    ){
      history.push(step)
      step = 2
    } else {
      history.push(step)
      step = 3
    }

    render()
    return
  }

  // שלב הפקדה
  if(step === 2){
    data.deposit = document.getElementById("deposit").value
    history.push(step)
    step = 3
    render()
    return
  }
}

function back(){
  if(!history.length) return
  step = history.pop()
  render()
}

render()
</script>

</body>
</html>